<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\api\Base.js - ice-framework</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://ice-framework.gamonoid.com/logo.png" title="ice-framework"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Base.js.html">Base.js</a></li>
                                <li><a href="../classes/BaseService.html">BaseService</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src\api\Base.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
This file is part of Ice Framework.

Ice Framework is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Ice Framework is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with Ice Framework. If not, see &lt;http://www.gnu.org/licenses/&gt;.

------------------------------------------------------------------

Original work Copyright (c) 2012 [Gamonoid Media Pvt. Ltd]  
Developer: Thilina Hasantha (thilina.hasantha[at]gmail.com / facebook.com/thilinah)
 */



/**
 * The base class for providing core functions to all module classes.
 * @class Base.js
 */
function IceHRMBase() {
	this.deleteParams = {};
	this.createRemoteTable = false;
	this.instanceId = &quot;None&quot;;
	this.ga = [];
	this.showEdit = true;
	this.showDelete = true;
	this.showSave = true;
	this.showCancel = true;
	this.showFormOnPopup = false;
	this.filtersAlreadySet = false;
	this.currentFilterString = &quot;&quot;;
}

this.fieldTemplates = null;
this.templates = null;
this.customTemplates = null;
this.emailTemplates = null;
this.fieldMasterData = null;
this.fieldMasterDataKeys = null;
this.fieldMasterDataCallback = null;
this.sourceMapping = null;
this.currentId = null;
this.user = null;
this.currentProfile = null;
this.permissions = {};



this.baseUrl = null;

IceHRMBase.method(&#x27;init&#x27; , function(appName, currentView, dataUrl, permissions) {
	
});

/**
 * Some browsers do not support sending JSON in get parameters. Set this to true to avoid sending JSON
 * @method setNoJSONRequests
 * @param val {Boolean}
 */
IceHRMBase.method(&#x27;setNoJSONRequests&#x27; , function(val) {
	this.noJSONRequests = val;
});


IceHRMBase.method(&#x27;setPermissions&#x27; , function(permissions) {
	this.permissions = permissions;
});

/**
 * Check if the current user has a permission
 * @method checkPermission
 * @param permission {String}
 * @example
 * 	this.checkPermission(&quot;Upload/Delete Profile Image&quot;)
 */
IceHRMBase.method(&#x27;checkPermission&#x27; , function(permission) {
	if(this.permissions[permission] == undefined || this.permissions[permission] == null || this.permissions[permission] == &quot;Yes&quot;){
		return &quot;Yes&quot;;
	}else{
		return this.permissions[permission];
	}
});

IceHRMBase.method(&#x27;setBaseUrl&#x27; , function(url) {
	this.baseUrl = url;
});

IceHRMBase.method(&#x27;setUser&#x27; , function(user) {
	this.user = user;
});

IceHRMBase.method(&#x27;getUser&#x27; , function() {
	return this.user;
});

IceHRMBase.method(&#x27;setInstanceId&#x27; , function(id) {
	this.instanceId = id;
});

IceHRMBase.method(&#x27;setGoogleAnalytics&#x27; , function(ga) {
	this.ga = ga;
});

/**
 * If this method returned false the action buttons in data table for modules will not be displayed.
 * Override this method in module lib.js to hide action buttons
 * @method showActionButtons
 * @param permission {String}
 * @example
 * 	EmployeeLeaveEntitlementAdapter.method(&#x27;showActionButtons&#x27; , function() {
 *  	return false;
 *	});
 */
IceHRMBase.method(&#x27;showActionButtons&#x27; , function() {
	return true;
});

IceHRMBase.method(&#x27;trackEvent&#x27; , function(action, label, value) {
	try{
		if(label == undefined || label == null){
			this.ga.push([&#x27;_trackEvent&#x27;, this.instanceId, action]);
		}else if(value == undefined || value == null){
			this.ga.push([&#x27;_trackEvent&#x27;, this.instanceId, action, label]);
		}else{
			this.ga.push([&#x27;_trackEvent&#x27;, this.instanceId, action, label, value]);
		}
	}catch(e){
		
	}
	
	
});


IceHRMBase.method(&#x27;setCurrentProfile&#x27; , function(currentProfile) {
	this.currentProfile = currentProfile;
});

/**
 * Get the current profile
 * @method getCurrentProfile
 * @returns Profile of the current user if the profile is not switched if not switched profile
 */

IceHRMBase.method(&#x27;getCurrentProfile&#x27; , function() {
	return this.currentProfile;
});

/**
 * Retrive data required to create select boxes for add new /edit forms for a given module. This is called when loading the module
 * @method initFieldMasterData
 * @param callback {Function} call this once loading completed
 * @param callback {Function} call this once all field loading completed. This indicate that the form can be displayed saftly
 * @example
 * 	ReportAdapter.method(&#x27;renderForm&#x27;, function(object) {
 *		var that = this;
 *		this.processFormFieldsWithObject(object);
 *		var cb = function(){
 *			that.uber(&#x27;renderForm&#x27;,object);
 *		};
 *		this.initFieldMasterData(cb);
 *      });
 */
IceHRMBase.method(&#x27;initFieldMasterData&#x27; , function(callback, loadAllCallback) {
	var values;
	if(this.showAddNew == undefined || this.showAddNew == null){
		this.showAddNew = true;
	}
	this.fieldMasterData = {};
	this.fieldMasterDataKeys = {};
	this.fieldMasterDataCallback = loadAllCallback;
	this.sourceMapping = {};
	var fields = this.getFormFields();
	var filterFields = this.getFilters();
	
	if(filterFields != null){
		for(var j=0;j&lt;filterFields.length;j++){
			values = this.getMetaFieldValues(filterFields[j][0],fields);
			if(values == null || (values[&#x27;type&#x27;]!= &quot;select&quot; &amp;&amp; values[&#x27;type&#x27;]!= &quot;select2&quot; &amp;&amp; values[&#x27;type&#x27;]!= &quot;select2multi&quot;)){
				fields.push(filterFields[j]);
			}
		}
	}
	
	
	var remoteSourceFields = [];
	var remoteSourceFieldKeys = [];
	var field = null;
	var fieldSub = null;
	for(var i=0;i&lt;fields.length;i++){
		field = fields[i];
		if(field[1][&#x27;remote-source&#x27;] != undefined &amp;&amp; field[1][&#x27;remote-source&#x27;] != null){
			var key = field[1][&#x27;remote-source&#x27;][0]+&quot;_&quot;+field[1][&#x27;remote-source&#x27;][1]+&quot;_&quot;+field[1][&#x27;remote-source&#x27;][2];
			if(remoteSourceFieldKeys.indexOf(key) &lt; 0){
				remoteSourceFields.push(field);
				remoteSourceFieldKeys.push(key);
			}
			
		}else if(field[1][&#x27;form&#x27;] != undefined &amp;&amp; field[1][&#x27;form&#x27;] != null){
			for(var j=0;j&lt;field[1][&#x27;form&#x27;].length;j++){
				fieldSub = field[1][&#x27;form&#x27;][j];
				if(fieldSub[1][&#x27;remote-source&#x27;] != undefined &amp;&amp; fieldSub[1][&#x27;remote-source&#x27;] != null){
					var key = fieldSub[1][&#x27;remote-source&#x27;][0]+&quot;_&quot;+fieldSub[1][&#x27;remote-source&#x27;][1]+&quot;_&quot;+fieldSub[1][&#x27;remote-source&#x27;][2];
					if(remoteSourceFieldKeys.indexOf(key) &lt; 0){
						remoteSourceFields.push(fieldSub);
						remoteSourceFieldKeys.push(key);
					}
					
				}
			}
		}
	}
	
	for(var i=0;i&lt;remoteSourceFields.length;i++){
		var field = remoteSourceFields[i];
		if(field[1][&#x27;remote-source&#x27;] != undefined &amp;&amp; field[1][&#x27;remote-source&#x27;] != null){
			var key = field[1][&#x27;remote-source&#x27;][0]+&quot;_&quot;+field[1][&#x27;remote-source&#x27;][1]+&quot;_&quot;+field[1][&#x27;remote-source&#x27;][2];
			this.fieldMasterDataKeys[key] = false;
			this.sourceMapping[field[0]] = field[1][&#x27;remote-source&#x27;];
			
			var callBackData = {};
			callBackData[&#x27;callBack&#x27;] = &#x27;initFieldMasterDataResponse&#x27;;
			callBackData[&#x27;callBackData&#x27;] = [key];
			if(callback != null &amp;&amp; callback != undefined){
				callBackData[&#x27;callBackSuccess&#x27;] = callback;
			}
			this.getFieldValues(field[1][&#x27;remote-source&#x27;],callBackData);
		}
	}
});

/**
 * Pass true to this method after creating module JS object to open new/edit entry form for the module on a popup.
 * @method setShowFormOnPopup
 * @param val {Boolean}
 * @example
 * 	modJs.subModJsList[&#x27;tabCandidateApplication&#x27;] = new CandidateApplicationAdapter(&#x27;Application&#x27;,&#x27;CandidateApplication&#x27;,{&quot;candidate&quot;:data.id});
 *	modJs.subModJsList[&#x27;tabCandidateApplication&#x27;].setShowFormOnPopup(true);
 */

IceHRMBase.method(&#x27;setShowFormOnPopup&#x27; , function(val) {
	this.showFormOnPopup = val;
});

/**
 * Set this to true to if you need the datatable to load data page by page instead of loading all data at once.
 * @method setRemoteTable
 * @param val {Boolean}
 * @example
 * 	modJs.subModJsList[&#x27;tabCandidateApplication&#x27;] = new CandidateApplicationAdapter(&#x27;Application&#x27;,&#x27;CandidateApplication&#x27;,{&quot;candidate&quot;:data.id});
 *	modJs.subModJsList[&#x27;tabCandidateApplication&#x27;].setRemoteTable(true);
 */

IceHRMBase.method(&#x27;setRemoteTable&#x27; , function(val) {
	this.createRemoteTable = val;
});

IceHRMBase.method(&#x27;getRemoteTable&#x27; , function() {
	return this.createRemoteTable;
});

IceHRMBase.method(&#x27;isAllLoaded&#x27; , function(fieldMasterDataKeys) {
	
	for(key in fieldMasterDataKeys){
		if(fieldMasterDataKeys[key] == false){
			return false;
		}
	}
	return true;
});

IceHRMBase.method(&#x27;initFieldMasterDataResponse&#x27; , function(key,data, callback) {
	this.fieldMasterData[key] = data;
	this.fieldMasterDataKeys[key] = true;

	if(callback != undefined &amp;&amp; callback != null){
		callback();
	}
	
	if(this.fieldMasterDataCallback != null &amp;&amp; this.fieldMasterDataCallback != undefined &amp;&amp; this.isAllLoaded(this.fieldMasterDataKeys)){
		this.fieldMasterDataCallback();
	}
	
});

IceHRMBase.method(&#x27;getMetaFieldValues&#x27; , function(key, fields) {
	for(var i=0;i&lt;fields.length;i++){
		if(key == fields[i][0]){
			return fields[i][1];
		}
	}
	return null;
});

IceHRMBase.method(&#x27;getSourceMapping&#x27; , function() {
	return this.sourceMapping ;
});

IceHRMBase.method(&#x27;setTesting&#x27; , function(testing) {
	this.testing = testing;
});

IceHRMBase.method(&#x27;consoleLog&#x27; , function(message) {
	if(this.testing) {
		console.log(message);
	}
});

IceHRMBase.method(&#x27;setClientMessages&#x27;, function(msgList) {
	this.msgList = msgList;
});

IceHRMBase.method(&#x27;setTemplates&#x27;, function(templates) {
	this.templates = templates;
});


IceHRMBase.method(&#x27;getWSProperty&#x27;, function(array, key) {
	if(array.hasOwnProperty(key)) {
		return array[key];
	}
	return null;
});


IceHRMBase.method(&#x27;getClientMessage&#x27;, function(key) {
	return this.getWSProperty(this.msgList,key);
});



IceHRMBase.method(&#x27;getTemplate&#x27;, function(key) {
	return this.getWSProperty(this.templates, key);
});

IceHRMBase.method(&#x27;setGoogleAnalytics&#x27;, function (gaq) {
	this.gaq = gaq;
});


IceHRMBase.method(&#x27;showView&#x27;, function(view) {
	if(this.currentView != null) {
		this.previousView = this.currentView;
		$(&quot;#&quot; + this.currentView).hide();
	}
	$(&#x27;#&#x27; + view).show();
	this.currentView = view;
	this.moveToTop();
});

IceHRMBase.method(&#x27;showPreviousView&#x27;, function() {
	this.showView(this.previousView);	
});


IceHRMBase.method(&#x27;moveToTop&#x27;, function () {
	
});


IceHRMBase.method(&#x27;callFunction&#x27;, function (callback, cbParams,thisParam) {
	if($.isFunction(callback)) {
		try{
			if(thisParam == undefined || thisParam == null){
				callback.apply(document, cbParams);
			}else{
				callback.apply(thisParam, cbParams);
			}
			
		} catch(e) {
		}
	} else {
		f = this[callback];
		if($.isFunction(f)) {
			try{
				f.apply(this, cbParams);
			} catch(e) {
			}
		} 
	}
	return ;
});

IceHRMBase.method(&#x27;getTableTopButtonHtml&#x27;, function() {
	var html = &quot;&quot;;
	if(this.getShowAddNew()){
		html = &#x27;&lt;button onclick=&quot;modJs.renderForm();return false;&quot; class=&quot;btn btn-small btn-primary&quot;&gt;&#x27;+this.getAddNewLabel()+&#x27; &lt;i class=&quot;fa fa-plus&quot;&gt;&lt;/i&gt;&lt;/button&gt;&#x27;;
	}
	
	if(this.getFilters() != null){
		if(html != &quot;&quot;){
			html += &quot;&amp;nbsp;&amp;nbsp;&quot;;
		}
		html+=&#x27;&lt;button onclick=&quot;modJs.showFilters();return false;&quot; class=&quot;btn btn-small btn-primary&quot;&gt;Fillter &lt;i class=&quot;fa fa-filter&quot;&gt;&lt;/i&gt;&lt;/button&gt;&#x27;;
		html += &quot;&amp;nbsp;&amp;nbsp;&quot;;
		if(this.filtersAlreadySet){
			html+=&#x27;&lt;button id=&quot;__id___resetFilters&quot; onclick=&quot;modJs.resetFilters();return false;&quot; class=&quot;btn btn-small btn-default&quot;&gt;__filterString__ &lt;i class=&quot;fa fa-times&quot;&gt;&lt;/i&gt;&lt;/button&gt;&#x27;;
		}else{
			html+=&#x27;&lt;button id=&quot;__id___resetFilters&quot; onclick=&quot;modJs.resetFilters();return false;&quot; class=&quot;btn btn-small btn-default&quot; style=&quot;display:none;&quot;&gt;__filterString__ &lt;i class=&quot;fa fa-times&quot;&gt;&lt;/i&gt;&lt;/button&gt;&#x27;;
		}
		
	}
	
	html = html.replace(/__id__/g, this.getTableName());
	
	if(this.currentFilterString != &quot;&quot; &amp;&amp; this.currentFilterString != null){
		html = html.replace(/__filterString__/g, this.currentFilterString);
	}else{
		html = html.replace(/__filterString__/g, &#x27;Reset Filters&#x27;);
	}
	
	if(html != &quot;&quot;){
		html = &#x27;&lt;div class=&quot;row&quot;&gt;&lt;div class=&quot;col-xs-12&quot;&gt;&#x27;+html+&#x27;&lt;/div&gt;&lt;/div&gt;&#x27;;
	}
	
	return html;
});

/**
 * Create the data table on provided element id
 * @method createTable
 * @param val {Boolean}
 */

IceHRMBase.method(&#x27;createTable&#x27;, function(elementId) {
	
	if(this.getRemoteTable()){
		this.createTableServer(elementId);
		return;
	}
	
	
	var headers = this.getHeaders();
	var data = this.getTableData();
	
	if(this.showActionButtons()){
		headers.push({ &quot;sTitle&quot;: &quot;&quot;, &quot;sClass&quot;: &quot;center&quot; });
	}
	
	
	if(this.showActionButtons()){
		for(var i=0;i&lt;data.length;i++){
			data[i].push(this.getActionButtonsHtml(data[i][0],data[i]));
		}
	}
	
	var html = &quot;&quot;;
	html = this.getTableTopButtonHtml()+&#x27;&lt;div class=&quot;box-body table-responsive&quot;&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; class=&quot;table table-bordered table-striped&quot; id=&quot;grid&quot;&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;
	/*
	if(this.getShowAddNew()){
		html = this.getTableTopButtonHtml()+&#x27;&lt;div class=&quot;box-body table-responsive&quot;&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; class=&quot;table table-bordered table-striped&quot; id=&quot;grid&quot;&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;
	}else{
		html = &#x27;&lt;div class=&quot;box-body table-responsive&quot;&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; class=&quot;table table-bordered table-striped&quot; id=&quot;grid&quot;&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;
	}
	*/
	//Find current page
	var activePage = $(&#x27;#&#x27;+elementId +&quot; .dataTables_paginate .active a&quot;).html();
	var start = 0;
	if(activePage != undefined &amp;&amp; activePage != null){
		start = parseInt(activePage, 10)*15 - 15;
	}

	$(&#x27;#&#x27;+elementId).html(html);
	
	var dataTableParams = {
			&quot;oLanguage&quot;: {
				&quot;sLengthMenu&quot;: &quot;_MENU_ records per page&quot;
			},
			&quot;aaData&quot;: data,
			&quot;aoColumns&quot;: headers,
			&quot;bSort&quot;: false,
			&quot;iDisplayLength&quot;: 15,
			&quot;iDisplayStart&quot;: start
		};
	
	/*
	 &quot;fnInitComplete&quot;: function(oSettings, json) {
				if(activePage != undefined &amp;&amp; activePage != null){
					$(&#x27;#&#x27;+elementId+&quot; .dataTables_paginate a:contains(&#x27;&quot;+activePage+&quot;&#x27;)&quot;).click();
				}
			}
	 */
	
	var customTableParams = this.getCustomTableParams();
	
	$.extend(dataTableParams, customTableParams);
	
	$(&#x27;#&#x27;+elementId+&#x27; #grid&#x27;).dataTable( dataTableParams );
	
	$(&quot;.dataTables_paginate ul&quot;).addClass(&quot;pagination&quot;);
	$(&quot;.dataTables_length&quot;).hide();
	$(&quot;.dataTables_filter input&quot;).addClass(&quot;form-control&quot;);
	$(&quot;.dataTables_filter input&quot;).attr(&quot;placeholder&quot;,&quot;Search&quot;);
	$(&quot;.dataTables_filter label&quot;).contents().filter(function(){
	    return (this.nodeType == 3);
	}).remove();
	$(&#x27;.tableActionButton&#x27;).tooltip();
});

/**
 * Create a data table on provided element id which loads data page by page
 * @method createTableServer
 * @param val {Boolean}
 */

IceHRMBase.method(&#x27;createTableServer&#x27;, function(elementId) {
	var that = this;
	var headers = this.getHeaders();
	
	headers.push({ &quot;sTitle&quot;: &quot;&quot;, &quot;sClass&quot;: &quot;center&quot; });
	
	var html = &quot;&quot;;
	html = this.getTableTopButtonHtml()+&#x27;&lt;div class=&quot;box-body table-responsive&quot;&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; class=&quot;table table-bordered table-striped&quot; id=&quot;grid&quot;&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;
	/*
	if(this.getShowAddNew()){
		html = this.getTableTopButtonHtml()+&#x27;&lt;div class=&quot;box-body table-responsive&quot;&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; class=&quot;table table-bordered table-striped&quot; id=&quot;grid&quot;&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;
	}else{
		html = &#x27;&lt;div class=&quot;box-body table-responsive&quot;&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; border=&quot;0&quot; class=&quot;table table-bordered table-striped&quot; id=&quot;grid&quot;&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;
	}
	*/
	
	//Find current page
	var activePage = $(&#x27;#&#x27;+elementId +&quot; .dataTables_paginate .active a&quot;).html();
	var start = 0;
	if(activePage != undefined &amp;&amp; activePage != null){
		start = parseInt(activePage, 10)*15 - 15;
	}
	
	
	$(&#x27;#&#x27;+elementId).html(html);
	
	var dataTableParams = {
			&quot;oLanguage&quot;: {
				&quot;sLengthMenu&quot;: &quot;_MENU_ records per page&quot;
			},
			&quot;bProcessing&quot;: true,
		    &quot;bServerSide&quot;: true,
		    &quot;sAjaxSource&quot;: that.getDataUrl(that.getDataMapping()),
			&quot;aoColumns&quot;: headers,
			&quot;bSort&quot;: false,
			&quot;parent&quot;:that,
			&quot;iDisplayLength&quot;: 15,
			&quot;iDisplayStart&quot;: start
		};
	
	if(this.showActionButtons()){
		dataTableParams[&quot;aoColumnDefs&quot;] = [ 
		                        			{
		                         				&quot;fnRender&quot;: that.getActionButtons,
		                         				&quot;aTargets&quot;: [that.getDataMapping().length]
		                         			}
		                    			];
	}
	
	var customTableParams = this.getCustomTableParams();
	
	$.extend(dataTableParams, customTableParams);
	
	$(&#x27;#&#x27;+elementId+&#x27; #grid&#x27;).dataTable( dataTableParams );
	
	$(&quot;.dataTables_paginate ul&quot;).addClass(&quot;pagination&quot;);
	$(&quot;.dataTables_length&quot;).hide();
	$(&quot;.dataTables_filter input&quot;).addClass(&quot;form-control&quot;);
	$(&quot;.dataTables_filter input&quot;).attr(&quot;placeholder&quot;,&quot;Search&quot;);
	$(&quot;.dataTables_filter label&quot;).contents().filter(function(){
	    return (this.nodeType == 3);
	}).remove();
	
	$(&#x27;.tableActionButton&#x27;).tooltip();
});

/**
 * This should be overridden in module lib.js classes to return module headers which are used to create the data table.
 * @method getHeaders
 * @example
	SettingAdapter.method(&#x27;getHeaders&#x27;, function() {
  		return [
			{ &quot;sTitle&quot;: &quot;ID&quot; ,&quot;bVisible&quot;:false},
			{ &quot;sTitle&quot;: &quot;Name&quot; },
			{ &quot;sTitle&quot;: &quot;Value&quot;},
			{ &quot;sTitle&quot;: &quot;Details&quot;}
		];
		});
 */
IceHRMBase.method(&#x27;getHeaders&#x27;, function() {
	
});


/**
 * This should be overridden in module lib.js classes to return module field values which are used to create the data table.
 * @method getDataMapping
 * @example
	SettingAdapter.method(&#x27;getDataMapping&#x27;, function() {
	return [
	        &quot;id&quot;,
	        &quot;name&quot;,
	        &quot;value&quot;,
	        &quot;description&quot;
	];
	});
 */

IceHRMBase.method(&#x27;getDataMapping&#x27;, function() {

});

/**
 * This should be overridden in module lib.js classes to return module from fields which are used to create the add/edit form and also used for initializing select box values in form.
 * @method getFormFields
 * @example
	SettingAdapter.method(&#x27;getFormFields&#x27;, function() {
	return [
	        [ &quot;id&quot;, {&quot;label&quot;:&quot;ID&quot;,&quot;type&quot;:&quot;hidden&quot;}],
	        [ &quot;value&quot;, {&quot;label&quot;:&quot;Value&quot;,&quot;type&quot;:&quot;text&quot;,&quot;validation&quot;:&quot;none&quot;}]
	];
	});
 */
IceHRMBase.method(&#x27;getFormFields&#x27;, function() {
	
});

IceHRMBase.method(&#x27;getTableData&#x27;, function() {
	
});

/**
 * This can be overridden in module lib.js classes inorder to show a filter form
 * @method getFilters
 * @example
	EmployeeAdapter.method(&#x27;getFilters&#x27;, function() {
		return [
		        [ &quot;job_title&quot;, {&quot;label&quot;:&quot;Job Title&quot;,&quot;type&quot;:&quot;select2&quot;,&quot;allow-null&quot;:true,&quot;null-label&quot;:&quot;All Job Titles&quot;,&quot;remote-source&quot;:[&quot;JobTitle&quot;,&quot;id&quot;,&quot;name&quot;]}],
		        [ &quot;department&quot;, {&quot;label&quot;:&quot;Department&quot;,&quot;type&quot;:&quot;select2&quot;,&quot;allow-null&quot;:true,&quot;null-label&quot;:&quot;All Departments&quot;,&quot;remote-source&quot;:[&quot;CompanyStructure&quot;,&quot;id&quot;,&quot;title&quot;]}],
		        [ &quot;supervisor&quot;, {&quot;label&quot;:&quot;Supervisor&quot;,&quot;type&quot;:&quot;select2&quot;,&quot;allow-null&quot;:true,&quot;null-label&quot;:&quot;Anyone&quot;,&quot;remote-source&quot;:[&quot;Employee&quot;,&quot;id&quot;,&quot;first_name+last_name&quot;]}]
		];
	});
 */
IceHRMBase.method(&#x27;getFilters&#x27;, function() {
	return null;
});

/**
 * Show the edit form for an item
 * @method edit
 * @param id {int} id of the item to edit
 */
IceHRMBase.method(&#x27;edit&#x27;, function(id) {
	this.currentId = id;
	this.getElement(id,[]);
});

IceHRMBase.method(&#x27;renderModel&#x27;, function(id,header,body) {
	$(&#x27;#&#x27;+id+&#x27;ModelBody&#x27;).html(&quot;&quot;);
	
	if(body == undefined || body == null){
		body = &quot;&quot;;
	}
	
	$(&#x27;#&#x27;+id+&#x27;ModelLabel&#x27;).html(header);
	$(&#x27;#&#x27;+id+&#x27;ModelBody&#x27;).html(body);
});

IceHRMBase.method(&#x27;renderModelFromDom&#x27;, function(id,header,element) {
	$(&#x27;#&#x27;+id+&#x27;ModelBody&#x27;).html(&quot;&quot;);
	
	if(element == undefined || element == null){
		element = $(&quot;&lt;div&gt;&lt;/div&gt;&quot;);
	}
	
	$(&#x27;#&#x27;+id+&#x27;ModelLabel&#x27;).html(header);
	$(&#x27;#&#x27;+id+&#x27;ModelBody&#x27;).html(&quot;&quot;);
	$(&#x27;#&#x27;+id+&#x27;ModelBody&#x27;).append(element);
});

/**
 * Delete an item
 * @method deleteRow
 * @param id {int} id of the item to edit
 */

IceHRMBase.method(&#x27;deleteRow&#x27;, function(id) {
	this.deleteParams[&#x27;id&#x27;] = id;
	this.renderModel(&#x27;delete&#x27;,&quot;Confirm Deletion&quot;,&quot;Are you sure you want to delete this item ?&quot;);
	$(&#x27;#deleteModel&#x27;).modal(&#x27;show&#x27;);
	
});

/**
 * Show a popup with message
 * @method showMessage
 * @param title {String} title of the message box
 * @param message {String} message
 * @param closeCallback {Function} this will be called once the dialog is closed (optional)
 * @param closeCallback {Function} data to pass to close callback (optional)
 * @param isPlain {Boolean} if true buttons are not shown (optional / default = true)
 * @example
 * 	this.showMessage(&quot;Error Occured while Applying Leave&quot;, callBackData);
 */
IceHRMBase.method(&#x27;showMessage&#x27;, function(title,message,closeCallback,closeCallbackData, isPlain) {
	var that = this;
	var modelId = &quot;&quot;;
	if(isPlain){
		modelId = &quot;#plainMessageModel&quot;;
		this.renderModel(&#x27;plainMessage&#x27;,title,message);
	}else{
		modelId = &quot;#messageModel&quot;;
		this.renderModel(&#x27;message&#x27;,title,message);
	}
	
	$(modelId).unbind(&#x27;hide&#x27;);
	if(closeCallback != null &amp;&amp; closeCallback != undefined){
		$(modelId).on(&#x27;hidden.bs.modal&#x27;,function(){
			closeCallback.apply(that,closeCallbackData);
			$(modelId).unbind(&#x27;hidden.bs.modal&#x27;);
		});
	}
	$(modelId).modal({
		  backdrop: &#x27;static&#x27;
	});
});

IceHRMBase.method(&#x27;showDomElement&#x27;, function(title,element,closeCallback,closeCallbackData, isPlain) {
	var that = this;
	var modelId = &quot;&quot;;
	if(isPlain){
		modelId = &quot;#plainMessageModel&quot;;
		this.renderModelFromDom(&#x27;plainMessage&#x27;,title,element);
	}else{
		modelId = &quot;#messageModel&quot;;
		this.renderModelFromDom(&#x27;message&#x27;,title,element);
	}
	
	$(modelId).unbind(&#x27;hide&#x27;);
	if(closeCallback != null &amp;&amp; closeCallback != undefined){
		$(modelId).on(&#x27;hidden.bs.modal&#x27;,function(){
			closeCallback.apply(that,closeCallbackData);
			$(modelId).unbind(&#x27;hidden.bs.modal&#x27;);
		});
	}
	$(modelId).modal({
		  backdrop: &#x27;static&#x27;
	});
});

IceHRMBase.method(&#x27;confirmDelete&#x27;, function() {
	if(this.deleteParams[&#x27;id&#x27;] != undefined || this.deleteParams[&#x27;id&#x27;] != null){
		this.deleteObj(this.deleteParams[&#x27;id&#x27;],[]);
	}
	$(&#x27;#deleteModel&#x27;).modal(&#x27;hide&#x27;);
});

IceHRMBase.method(&#x27;cancelDelete&#x27;, function() {
	$(&#x27;#deleteModel&#x27;).modal(&#x27;hide&#x27;);
	this.deleteParams[&#x27;id&#x27;] = null;
});

IceHRMBase.method(&#x27;closeMessage&#x27;, function() {
	$(&#x27;#messageModel&#x27;).modal(&#x27;hide&#x27;);
});

IceHRMBase.method(&#x27;closePlainMessage&#x27;, function() {
	$(&#x27;#plainMessageModel&#x27;).modal(&#x27;hide&#x27;);
});


/**
 * Create or edit an element 
 * @method save
 */

IceHRMBase.method(&#x27;save&#x27;, function() {
	var validator = new FormValidation(this.getTableName()+&quot;_submit&quot;,true,{&#x27;ShowPopup&#x27;:false,&quot;LabelErrorClass&quot;:&quot;error&quot;});
	if(validator.checkValues()){
		var params = validator.getFormParameters();
		params = this.forceInjectValuesBeforeSave(params);
		var msg = this.doCustomValidation(params);
		if(msg == null){
			var id = $(&#x27;#&#x27;+this.getTableName()+&quot;_submit #id&quot;).val();
			if(id != null &amp;&amp; id != undefined &amp;&amp; id != &quot;&quot;){
				$(params).attr(&#x27;id&#x27;,id);
			}
			this.add(params,[]);
		}else{
			$(&quot;#&quot;+this.getTableName()+&#x27;Form .label&#x27;).html(msg);
			$(&quot;#&quot;+this.getTableName()+&#x27;Form .label&#x27;).show();
		}
		
	}
});

/**
 * Override this method to inject attitional parameters or modify existing parameters retrived from add/edit form before sending to the server
 * @method forceInjectValuesBeforeSave
 * @param params {Array} keys and values in form
 * @returns {Array} modified parameters
 */
IceHRMBase.method(&#x27;forceInjectValuesBeforeSave&#x27;, function(params) {
	return params;
});

/**
 * Override this method to do custom validations at client side
 * @method doCustomValidation
 * @param params {Array} keys and values in form
 * @returns {Null or String} return null if validation success, returns error message if unsuccessful
 * @example
 	EmployeeLeaveAdapter.method(&#x27;doCustomValidation&#x27;, function(params) {
		try{
			if(params[&#x27;date_start&#x27;] != params[&#x27;date_end&#x27;]){
				var ds = new Date(params[&#x27;date_start&#x27;]);
				var de = new Date(params[&#x27;date_end&#x27;]);
				if(de &lt; ds){
					return &quot;Start date should be earlier than end date of the leave period&quot;;
				}
			}
		}catch(e){
			
		}
	return null;
});
 */
IceHRMBase.method(&#x27;doCustomValidation&#x27;, function(params) {
	return null;
});

IceHRMBase.method(&#x27;filterQuery&#x27;, function() {
	
	var validator = new FormValidation(this.getTableName()+&quot;_filter&quot;,true,{&#x27;ShowPopup&#x27;:false,&quot;LabelErrorClass&quot;:&quot;error&quot;});
	if(validator.checkValues()){
		var params = validator.getFormParameters();
		if(this.doCustomFilterValidation(params)){
			
			//remove null params
			for (var prop in params) {
				if(params.hasOwnProperty(prop)){
					if(params[prop] == &quot;NULL&quot;){
						delete(params[prop]);
					}
				}
			}
			
			this.setFilter(params);
			this.filtersAlreadySet = true;
			$(&quot;#&quot;+this.getTableName()+&quot;_resetFilters&quot;).show();
			this.currentFilterString = this.getFilterString(params);
			
			this.get([]);
			this.closePlainMessage();
		}
		
	}
});


IceHRMBase.method(&#x27;getFilterString&#x27;, function(filters) {

	var str = &#x27;&#x27;;
	var rmf, source, values;
	
	var filterFields = this.getFilters();
	
	for (var prop in filters) {
		if(filters.hasOwnProperty(prop)){
			
			if(str != &#x27;&#x27;){
				str += &quot; | &quot;;
			}
			
			values = this.getMetaFieldValues(prop,filterFields);
			
			str += values[&#x27;label&#x27;]+&quot; = &quot;;
			if((values[&#x27;type&#x27;] == &#x27;select&#x27; || values[&#x27;type&#x27;] == &#x27;select2&#x27; || values[&#x27;type&#x27;] == &#x27;select2multi&#x27;)){
				
				if(values[&#x27;remote-source&#x27;]!= undefined &amp;&amp; values[&#x27;remote-source&#x27;]!= null){
					rmf = values[&#x27;remote-source&#x27;];
					if(filters[prop] == &quot;NULL&quot;){
						if(values[&#x27;null-label&#x27;] != undefined &amp;&amp; values[&#x27;null-label&#x27;] != null){
							str += values[&#x27;null-label&#x27;];
						}else{
							str += &quot;Not Selected&quot;;
						}
					}else{
						str += this.fieldMasterData[rmf[0]+&quot;_&quot;+rmf[1]+&quot;_&quot;+rmf[2]][filters[prop]];
					}
					
				}else{
					source = values[&#x27;source&#x27;][0];
					if(filters[prop] == &quot;NULL&quot;){
						if(values[&#x27;null-label&#x27;] != undefined &amp;&amp; values[&#x27;null-label&#x27;] != null){
							str += values[&#x27;null-label&#x27;];
						}else{
							str += &quot;Not Selected&quot;;
						}
					}else{
						for(var i=0; i&lt;source.length; i++){
							if(filters[prop] == source[i]){
								str += values[&#x27;source&#x27;][1][i];
								break;
							}
						}
					}
					
					
				}
			}else{
				str += filters[prop];
			}
		}
	}
	
	return str;
});

/**
 * Override this method to do custom validations at client side for values selected in filters
 * @method doCustomFilterValidation
 * @param params {Array} keys and values in form
 * @returns {Null or String} return null if validation success, returns error message if unsuccessful
 */
IceHRMBase.method(&#x27;doCustomFilterValidation&#x27;, function(params) {
	return true;
});


/**
 * Reset selected filters
 * @method resetFilters
 */

IceHRMBase.method(&#x27;resetFilters&#x27;, function() {
	this.filter = this.origFilter;
	this.filtersAlreadySet = false;
	$(&quot;#&quot;+this.getTableName()+&quot;_resetFilters&quot;).hide();
	this.currentFilterString = &quot;&quot;;
	this.get([]);
});




IceHRMBase.method(&#x27;showFilters&#x27;, function(object) {
	var formHtml = this.templates[&#x27;filterTemplate&#x27;];
	var html = &quot;&quot;;
	var fields = this.getFilters();
	
	for(var i=0;i&lt;fields.length;i++){
		var metaField = this.getMetaFieldForRendering(fields[i][0]);
		if(metaField == &quot;&quot; || metaField == undefined){
			html += this.renderFormField(fields[i]);
		}else{
			var metaVal = object[metaField];
			if(metaVal != &#x27;&#x27; &amp;&amp; metaVal != null &amp;&amp; metaVal != undefined &amp;&amp; metaVal.trim() != &#x27;&#x27;){
				html += this.renderFormField(JSON.parse(metaVal));
			}else{
				html += this.renderFormField(fields[i]);
			}
		}
		
	}
	formHtml = formHtml.replace(/_id_/g,this.getTableName()+&quot;_filter&quot;);
	formHtml = formHtml.replace(/_fields_/g,html);
	
	var $tempDomObj;
	var randomFormId = this.generateRandom(14);
	$tempDomObj = $(&#x27;&lt;div class=&quot;reviewBlock popupForm&quot; data-content=&quot;Form&quot;&gt;&lt;/div&gt;&#x27;);
	$tempDomObj.attr(&#x27;id&#x27;,randomFormId);
	
	$tempDomObj.html(formHtml);
	
	
	$tempDomObj.find(&#x27;.datefield&#x27;).datepicker({&#x27;viewMode&#x27;:2});
	$tempDomObj.find(&#x27;.timefield&#x27;).datetimepicker({
      language: &#x27;en&#x27;,
      pickDate: false
    });
	$tempDomObj.find(&#x27;.datetimefield&#x27;).datetimepicker({
      language: &#x27;en&#x27;
    });
	
	//$tempDomObj.find(&#x27;.select2Field&#x27;).select2();
	$tempDomObj.find(&#x27;.select2Field&#x27;).each(function() {
		$(this).select2().select2(&#x27;val&#x27;, $(this).find(&quot;option:eq(0)&quot;).val());
	});
	
	$tempDomObj.find(&#x27;.select2Multi&#x27;).each(function() {
		$(this).select2().on(&quot;change&quot;,function(e){
			var parentRow = $(this).parents(&quot;.row&quot;);
			var height = parentRow.find(&quot;.select2-choices&quot;).height();
			parentRow.height(parseInt(height));
		});
	});

	//var tHtml = $tempDomObj.wrap(&#x27;&lt;div&gt;&#x27;).parent().html();
	this.showDomElement(&quot;Edit&quot;,$tempDomObj,null,null,true);
	$(&quot;.filterBtn&quot;).off();
	$(&quot;.filterBtn&quot;).on(&#x27;click&#x27;,function(e) {
		e.preventDefault();
		e.stopPropagation();
		try{
			modJs.filterQuery();
			
		}catch(e){
		};
		return false;
	});
	
	if(this.filter != undefined &amp;&amp; this.filter != null){
		this.fillForm(this.filter,&quot;#&quot;+this.getTableName()+&quot;_filter&quot;, this.getFilters());
	}
	
});


/**
 * Override this method in your module class to make changes to data fo the form before showing the form
 * @method preRenderForm
 * @param object {Array} keys value list for populating form		
 */

IceHRMBase.method(&#x27;preRenderForm&#x27;, function(object) {

});

/**
 * Create the form
 * @method renderForm
 * @param object {Array} keys value list for populating form		
 */

IceHRMBase.method(&#x27;renderForm&#x27;, function(object) {
	
	var that = this;
	
	this.preRenderForm(object);
	
	var formHtml = this.templates[&#x27;formTemplate&#x27;];
	var html = &quot;&quot;;
	var fields = this.getFormFields();
	
	for(var i=0;i&lt;fields.length;i++){
		var metaField = this.getMetaFieldForRendering(fields[i][0]);
		if(metaField == &quot;&quot; || metaField == undefined){
			html += this.renderFormField(fields[i]);
		}else{
			var metaVal = object[metaField];
			if(metaVal != &#x27;&#x27; &amp;&amp; metaVal != null &amp;&amp; metaVal != undefined &amp;&amp; metaVal.trim() != &#x27;&#x27;){
				html += this.renderFormField(JSON.parse(metaVal));
			}else{
				html += this.renderFormField(fields[i]);
			}
		}
		
	}
	formHtml = formHtml.replace(/_id_/g,this.getTableName()+&quot;_submit&quot;);
	formHtml = formHtml.replace(/_fields_/g,html);
	
	
	var $tempDomObj;
	var randomFormId = this.generateRandom(14);
	if(!this.showFormOnPopup){
		$tempDomObj = $(&quot;#&quot;+this.getTableName()+&#x27;Form&#x27;);
	}else{
		$tempDomObj = $(&#x27;&lt;div class=&quot;reviewBlock popupForm&quot; data-content=&quot;Form&quot;&gt;&lt;/div&gt;&#x27;);
		$tempDomObj.attr(&#x27;id&#x27;,randomFormId);
		
	}
	
	$tempDomObj.html(formHtml);
	
	
	$tempDomObj.find(&#x27;.datefield&#x27;).datepicker({&#x27;viewMode&#x27;:2});
	$tempDomObj.find(&#x27;.timefield&#x27;).datetimepicker({
      language: &#x27;en&#x27;,
      pickDate: false
    });
	$tempDomObj.find(&#x27;.datetimefield&#x27;).datetimepicker({
      language: &#x27;en&#x27;
    });
	
	//$tempDomObj.find(&#x27;.select2Field&#x27;).select2();
	$tempDomObj.find(&#x27;.select2Field&#x27;).each(function() {
		$(this).select2().select2(&#x27;val&#x27;, $(this).find(&quot;option:eq(0)&quot;).val());
		
	});
	
	$tempDomObj.find(&#x27;.select2Multi&#x27;).each(function() {
		$(this).select2().on(&quot;change&quot;,function(e){
			var parentRow = $(this).parents(&quot;.row&quot;);
			var height = parentRow.find(&quot;.select2-choices&quot;).height();
			parentRow.height(parseInt(height));
		});
		
	});
	
	for(var i=0;i&lt;fields.length;i++){
		if(fields[i][1].type == &quot;datagroup&quot;){
			$tempDomObj.find(&quot;#&quot;+fields[i][0]).data(&#x27;field&#x27;,fields[i]);
		}
	}
	
	if(this.showSave == false){
		$tempDomObj.find(&#x27;.saveBtn&#x27;).remove();
	}else{
		$tempDomObj.find(&#x27;.saveBtn&#x27;).off();
		$tempDomObj.find(&#x27;.saveBtn&#x27;).data(&quot;modJs&quot;,this);
		$tempDomObj.find(&#x27;.saveBtn&#x27;).on( &quot;click&quot;, function() {
			  $(this ).data(&#x27;modJs&#x27;).save();
			  return false;
		});
		
	}
	
	if(this.showCancel== false){
		$tempDomObj.find(&#x27;.cancelBtn&#x27;).remove();
	}else{
		$tempDomObj.find(&#x27;.cancelBtn&#x27;).off();
		$tempDomObj.find(&#x27;.cancelBtn&#x27;).data(&quot;modJs&quot;,this);
		$tempDomObj.find(&#x27;.cancelBtn&#x27;).on( &quot;click&quot;, function() {
			  $(this ).data(&#x27;modJs&#x27;).cancel();
			  return false;
		});
		
	}
	
	if(!this.showFormOnPopup){
		$(&quot;#&quot;+this.getTableName()+&#x27;Form&#x27;).show();
		$(&quot;#&quot;+this.getTableName()).hide();
		if(object != undefined &amp;&amp; object != null){
			this.fillForm(object);
		}
		
	}else{
		
		
		
		//var tHtml = $tempDomObj.wrap(&#x27;&lt;div&gt;&#x27;).parent().html();
		//this.showMessage(&quot;Edit&quot;,tHtml,null,null,true);
		this.showMessage(&quot;Edit&quot;,&quot;&quot;,null,null,true);
		
		$(&quot;#plainMessageModel .modal-body&quot;).html(&quot;&quot;);
		$(&quot;#plainMessageModel .modal-body&quot;).append($tempDomObj);
		
		if(object != undefined &amp;&amp; object != null){
			this.fillForm(object,&quot;#&quot;+randomFormId);
		}
	}
	
	this.postRenderForm(object,$tempDomObj);
	
	
	
});

/**
 * Override this method in your module class to make changes to data fo the form after showing it
 * @method postRenderForm
 * @param object {Array} keys value list for populating form
 * @param $tempDomObj {DOM} a DOM element for the form
 * @example
 * 	UserAdapter.method(&#x27;postRenderForm&#x27;, function(object, $tempDomObj) {
		if(object == null || object == undefined){
			$tempDomObj.find(&quot;#changePasswordBtn&quot;).remove();
		}
	});			
 */

IceHRMBase.method(&#x27;postRenderForm&#x27;, function(object, $tempDomObj) {

});

/**
 * Convert data group field to HTML
 * @method dataGroupToHtml
 * @param val {String} value in the field
 * @param field {Array} field meta data			
 */

IceHRMBase.method(&#x27;dataGroupToHtml&#x27;, function(val, field) {
	var data = JSON.parse(val),
		deleteButton, t, sortFunction, item,key = null, i, html, template, itemHtml, itemVal;
	
	deleteButton = &#x27;&lt;button id=&quot;#_id_#_delete&quot; onclick=&quot;modJs.deleteDataGroupItem(\&#x27;#_id_#\&#x27;);return false;&quot; type=&quot;button&quot; style=&quot;float:right;margin-right:-8px;&quot; tooltip=&quot;Delete&quot;&gt;&lt;li class=&quot;fa fa-times&quot;&gt;&lt;/li&gt;&lt;/button&gt;&#x27;;
	editButton = &#x27;&lt;button id=&quot;#_id_#_edit&quot; onclick=&quot;modJs.editDataGroupItem(\&#x27;#_id_#\&#x27;);return false;&quot; type=&quot;button&quot; style=&quot;float:right;margin-right:4px;&quot; tooltip=&quot;Edit&quot;&gt;&lt;li class=&quot;fa fa-edit&quot;&gt;&lt;/li&gt;&lt;/button&gt;&#x27;;
	
	template = field[1][&#x27;html&#x27;];
	
	if(data != null &amp;&amp; data != undefined &amp;&amp; field[1][&#x27;sort-function&#x27;] != undefined &amp;&amp; field[1][&#x27;sort-function&#x27;] != null){
		data.sort(field[1][&#x27;sort-function&#x27;]);
	}
	
	
	html = $(&quot;&lt;div&gt;&lt;div&gt;&quot;);
	
	
	
	for(i=0;i&lt;data.length;i++){
		item = data[i];
		
		if(field[1][&#x27;pre-format-function&#x27;] != undefined &amp;&amp; field[1][&#x27;pre-format-function&#x27;] != null){
			item = field[1][&#x27;pre-format-function&#x27;].apply(this,[item]);
		}
		
		t = template;
		t = t.replace(&#x27;#_delete_#&#x27;,deleteButton);
		t = t.replace(&#x27;#_edit_#&#x27;,editButton);
		t = t.replace(/#_id_#/g,item.id);
		
		for(key in item){
			itemVal = item[key];
			if(itemVal != undefined &amp;&amp; itemVal != null){
				itemVal = itemVal.replace(/(?:\r\n|\r|\n)/g, &#x27;&lt;br /&gt;&#x27;);
			}
			t = t.replace(&#x27;#_&#x27;+key+&#x27;_#&#x27;, itemVal);
		}
		
		itemHtml = $(t);
		itemHtml.attr(&#x27;fieldId&#x27;,field[0]+&quot;_div&quot;);
		html.append(itemHtml);
	}
	
	return html.wrap(&#x27;&lt;div&gt;&#x27;).parent().html();
});

/**
 * Reset the DataGroup for a given field
 * @method resetDataGroup
 * @param field {Array} field meta data		
 */
IceHRMBase.method(&#x27;resetDataGroup&#x27;, function(field) {
	$(&quot;#&quot;+field[0]).val(&quot;&quot;);
	$(&quot;#&quot;+field[0]+&quot;_div&quot;).html(&quot;&quot;);
});

IceHRMBase.method(&#x27;showDataGroup&#x27;, function(field, object) {
	var formHtml = this.templates[&#x27;datagroupTemplate&#x27;];
	var html = &quot;&quot;;
	var fields = field[1][&#x27;form&#x27;];
	
	if(object != undefined &amp;&amp; object != null &amp;&amp; object.id != undefined){
		this.currentDataGroupItemId = object.id;
	}else{
		this.currentDataGroupItemId = null;
	}
	
	for(var i=0;i&lt;fields.length;i++){
		html += this.renderFormField(fields[i]);
		
	}
	formHtml = formHtml.replace(/_id_/g,this.getTableName()+&quot;_field_&quot;+field[0]);
	formHtml = formHtml.replace(/_fields_/g,html);
	
	var $tempDomObj;
	var randomFormId = this.generateRandom(14);
	$tempDomObj = $(&#x27;&lt;div class=&quot;reviewBlock popupForm&quot; data-content=&quot;Form&quot;&gt;&lt;/div&gt;&#x27;);
	$tempDomObj.attr(&#x27;id&#x27;,randomFormId);
	
	$tempDomObj.html(formHtml);
	
	
	$tempDomObj.find(&#x27;.datefield&#x27;).datepicker({&#x27;viewMode&#x27;:2});
	$tempDomObj.find(&#x27;.timefield&#x27;).datetimepicker({
      language: &#x27;en&#x27;,
      pickDate: false
    });
	$tempDomObj.find(&#x27;.datetimefield&#x27;).datetimepicker({
      language: &#x27;en&#x27;
    });
	
	//$tempDomObj.find(&#x27;.select2Field&#x27;).select2();
	$tempDomObj.find(&#x27;.select2Field&#x27;).each(function() {
		$(this).select2().select2(&#x27;val&#x27;, $(this).find(&quot;option:eq(0)&quot;).val());
	});

	
	$tempDomObj.find(&#x27;.select2Multi&#x27;).each(function() {
		$(this).select2().on(&quot;change&quot;,function(e){
			var parentRow = $(this).parents(&quot;.row&quot;);
			var height = parentRow.find(&quot;.select2-choices&quot;).height();
			parentRow.height(parseInt(height));
		});
	});

	
	
	this.currentDataGroupField = field;
	this.showDomElement(&quot;Add &quot;+field[1][&#x27;label&#x27;],$tempDomObj,null,null,true);
	
	if(object != undefined &amp;&amp; object != null){
		this.fillForm(object,&quot;#&quot;+this.getTableName()+&quot;_field_&quot;+field[0], field[1][&#x27;form&#x27;]);
	}
	
	
	$(&quot;.groupAddBtn&quot;).off();
	if(object != undefined &amp;&amp; object != null &amp;&amp; object.id != undefined){
		$(&quot;.groupAddBtn&quot;).on(&#x27;click&#x27;,function(e) {
			e.preventDefault();
			e.stopPropagation();
			try{
				modJs.editDataGroup();
				
			}catch(e){
			};
			return false;
		});
	}else{
		$(&quot;.groupAddBtn&quot;).on(&#x27;click&#x27;,function(e) {
			e.preventDefault();
			e.stopPropagation();
			try{
				modJs.addDataGroup();
				
			}catch(e){
			};
			return false;
		});
	}
	
	
});

IceHRMBase.method(&#x27;addDataGroup&#x27;, function() {
	var field = this.currentDataGroupField, tempParams;
	$(&quot;#&quot;+this.getTableName()+&quot;_field_&quot;+field[0]+&quot;_error&quot;).html(&quot;&quot;);
	$(&quot;#&quot;+this.getTableName()+&quot;_field_&quot;+field[0]+&quot;_error&quot;).hide();
	var validator = new FormValidation(this.getTableName()+&quot;_field_&quot;+field[0],true,{&#x27;ShowPopup&#x27;:false,&quot;LabelErrorClass&quot;:&quot;error&quot;});
	if(validator.checkValues()){
		var params = validator.getFormParameters();
		if(field[1][&#x27;custom-validate-function&#x27;] != undefined &amp;&amp; field[1][&#x27;custom-validate-function&#x27;] != null){
			tempParams = field[1][&#x27;custom-validate-function&#x27;].apply(this,[params]);
			if(tempParams[&#x27;valid&#x27;]){
				params = tempParams[&#x27;params&#x27;];
			}else{
				$(&quot;#&quot;+this.getTableName()+&quot;_field_&quot;+field[0]+&quot;_error&quot;).html(tempParams[&#x27;message&#x27;]);
				$(&quot;#&quot;+this.getTableName()+&quot;_field_&quot;+field[0]+&quot;_error&quot;).show();
				return false;
			}
		}
		
		var val = $(&quot;#&quot;+field[0]).val();
		if(val == &quot;&quot;){
			val = &quot;[]&quot;;
		}
		var data = JSON.parse(val);
		
		params[&#x27;id&#x27;] = field[0]+&quot;_&quot;+this.dataGroupGetNextAutoIncrementId(data);
		data.push(params);
		
		val = JSON.stringify(data);
		$(&quot;#&quot;+field[0]).val(val);
		
		var html = this.dataGroupToHtml(val,field);
		
		$(&quot;#&quot;+field[0]+&quot;_div&quot;).html(html);
		
		this.closePlainMessage();
		
	}
});


IceHRMBase.method(&#x27;editDataGroup&#x27;, function() {
	var field = this.currentDataGroupField;
	var id = this.currentDataGroupItemId;
	var validator = new FormValidation(this.getTableName()+&quot;_field_&quot;+field[0],true,{&#x27;ShowPopup&#x27;:false,&quot;LabelErrorClass&quot;:&quot;error&quot;});
	if(validator.checkValues()){
		var params = validator.getFormParameters();
		if(this.doCustomFilterValidation(params)){
			
			var val = $(&quot;#&quot;+field[0]).val();
			if(val == &quot;&quot;){
				val = &quot;[]&quot;;
			}
			var data = JSON.parse(val);
			
			var editVal = {};
			var newVals = [];
			for(var i=0;i&lt;data.length;i++){
				item = data[i];
				if(item.id == id){
					editVal = item;
				}else{
					newVals.push(item);
				}
			}
			
			
			
			params[&#x27;id&#x27;] = editVal.id;
			newVals.push(params);
			
			val = JSON.stringify(newVals);
			$(&quot;#&quot;+field[0]).val(val);
			
			var html = this.dataGroupToHtml(val,field);
			
			$(&quot;#&quot;+field[0]+&quot;_div&quot;).html(html);
			
			this.closePlainMessage();
		}
		
	}
});

IceHRMBase.method(&#x27;editDataGroupItem&#x27;, function(id) {
	var fieldId = id.substring(0,id.lastIndexOf(&quot;_&quot;));
	
	var val = $(&quot;#&quot;+fieldId).val();
	var data = JSON.parse(val);
	
	var editVal = {};
	
	for(var i=0;i&lt;data.length;i++){
		item = data[i];
		if(item.id == id){
			editVal = item;
		}
	}
	
	this.showDataGroup($(&quot;#&quot;+fieldId).data(&#x27;field&#x27;),editVal);
	
	
});

IceHRMBase.method(&#x27;dataGroupGetNextAutoIncrementId&#x27;, function(data) {
	var autoId = 1, id;
	for(var i=0;i&lt;data.length;i++){
		item = data[i];
		if(item.id == undefined || item.id == null){
			item.id = 1;
		}
		id= item.id.substring(item.id.lastIndexOf(&quot;_&quot;)+1,item.id.length);
		if(id &gt;= autoId){
			autoId = parseInt(id) + 1;
		}
	}
	
	return autoId;
	
});

IceHRMBase.method(&#x27;deleteDataGroupItem&#x27;, function(id) {
	var fieldId = id.substring(0,id.lastIndexOf(&quot;_&quot;));
	
	var val = $(&quot;#&quot;+fieldId).val();
	var data = JSON.parse(val);
	
	var newVal = [];
	
	for(var i=0;i&lt;data.length;i++){
		item = data[i];
		if(item.id != id){
			newVal.push(item);
		}
	}
	
	$(&quot;#&quot;+fieldId).val(JSON.stringify(newVal));
	
	$(&quot;#&quot;+id).remove();
	
});


/**
 * Fill a form with required values after showing it
 * @method fillForm
 * @param object {Array} form data		
 * @param formId {String} id of the form
 * @param formId {Array} field meta data
 */

IceHRMBase.method(&#x27;fillForm&#x27;, function(object, formId, fields) {
	var placeHolderVal;
	if(fields == null || fields == undefined){
		fields = this.getFormFields();
	}
	
	if(formId == null || formId == undefined || formId == &quot;&quot;){
		formId = &quot;#&quot;+this.getTableName()+&#x27;Form&#x27;;
	}
	
	
	for(var i=0;i&lt;fields.length;i++) {
		if(fields[i][1].type == &#x27;date&#x27;){
			if(object[fields[i][0]] != &#x27;0000-00-00&#x27; &amp;&amp; object[fields[i][0]] != &#x27;&#x27; &amp;&amp; object[fields[i][0]] != null &amp;&amp; object[fields[i][0]] != undefined){
				$(formId + &#x27; #&#x27;+fields[i][0]+&quot;_date&quot;).datepicker(&#x27;setValue&#x27;, object[fields[i][0]]);
			}
		}else if(fields[i][1].type == &#x27;datetime&#x27; || fields[i][1].type == &#x27;time&#x27;){
			if(object[fields[i][0]] != &#x27;0000-00-00 00:00:00&#x27; &amp;&amp; object[fields[i][0]] != &#x27;&#x27; &amp;&amp; object[fields[i][0]] != null &amp;&amp; object[fields[i][0]] != undefined){
				var tempDate = object[fields[i][0]];
				var arr = tempDate.split(&quot; &quot;);
				var dateArr = arr[0].split(&quot;-&quot;);
				var timeArr = arr[1].split(&quot;:&quot;);
				$(formId + &#x27; #&#x27;+fields[i][0]+&quot;_datetime&quot;).data(&#x27;datetimepicker&#x27;).setLocalDate(new Date(dateArr[0], parseInt(dateArr[1])-1, dateArr[2], timeArr[0], timeArr[1], timeArr[2]));
			}
		}else if(fields[i][1].type == &#x27;label&#x27;){
			$(formId + &#x27; #&#x27;+fields[i][0]).html(object[fields[i][0]]);
		}else if(fields[i][1].type == &#x27;placeholder&#x27;){
			
			if(fields[i][1][&#x27;remote-source&#x27;] != undefined &amp;&amp; fields[i][1][&#x27;remote-source&#x27;] != null){
				var key = fields[i][1][&#x27;remote-source&#x27;][0]+&quot;_&quot;+fields[i][1][&#x27;remote-source&#x27;][1]+&quot;_&quot;+fields[i][1][&#x27;remote-source&#x27;][2];
				placeHolderVal = this.fieldMasterData[key][object[fields[i][0]]];
			}else{
				placeHolderVal = object[fields[i][0]];
			}
			
			if(placeHolderVal == undefined || placeHolderVal == null){
				placeHolderVal = &quot;&quot;;
			}else{
				placeHolderVal = placeHolderVal.replace(/(?:\r\n|\r|\n)/g, &#x27;&lt;br /&gt;&#x27;);
			}
			
			
			
			
			$(formId + &#x27; #&#x27;+fields[i][0]).html(placeHolderVal);
		}else if(fields[i][1].type == &#x27;fileupload&#x27;){
			if(object[fields[i][0]] != null &amp;&amp; object[fields[i][0]] != undefined &amp;&amp; object[fields[i][0]] != &quot;&quot;){
				$(formId + &#x27; #&#x27;+fields[i][0]).html(object[fields[i][0]]);
				$(formId + &#x27; #&#x27;+fields[i][0]).attr(&quot;val&quot;,object[fields[i][0]]);
				$(formId + &#x27; #&#x27;+fields[i][0]).show();
				$(formId + &#x27; #&#x27;+fields[i][0]+&quot;_download&quot;).show();
				
			}
			if(fields[i][1].readonly == true){
				$(formId + &#x27; #&#x27;+fields[i][0]+&quot;_upload&quot;).remove();
			}
		}else if(fields[i][1].type == &#x27;select&#x27;){
			if(object[fields[i][0]] == undefined || object[fields[i][0]] == null || object[fields[i][0]] == &quot;&quot;){
				object[fields[i][0]] = &quot;NULL&quot;;
			}
			$(formId + &#x27; #&#x27;+fields[i][0]).val(object[fields[i][0]]);
			
		}else if(fields[i][1].type == &#x27;select2&#x27;){
			if(object[fields[i][0]] == undefined || object[fields[i][0]] == null || object[fields[i][0]] == &quot;&quot;){
				object[fields[i][0]] = &quot;NULL&quot;;
			}
			$(formId + &#x27; #&#x27;+fields[i][0]).select2(&#x27;val&#x27;,object[fields[i][0]]);
			
		}else if(fields[i][1].type == &#x27;select2multi&#x27;){
			//TODO - SM
			if(object[fields[i][0]] == undefined || object[fields[i][0]] == null || object[fields[i][0]] == &quot;&quot;){
				object[fields[i][0]] = &quot;NULL&quot;;
			}
			
			var msVal = [];
			if(object[fields[i][0]] != undefined &amp;&amp; object[fields[i][0]] != null &amp;&amp; object[fields[i][0]] != &quot;&quot;){
				try{
					msVal = JSON.parse(object[fields[i][0]]);
				}catch(e){}
			}
			
			$(formId + &#x27; #&#x27;+fields[i][0]).select2(&#x27;val&#x27;,msVal);
		
		}else if(fields[i][1].type == &#x27;datagroup&#x27;){
			var html = this.dataGroupToHtml(object[fields[i][0]],fields[i]);
			$(formId + &#x27; #&#x27;+fields[i][0]).val(object[fields[i][0]]);
			$(formId + &#x27; #&#x27;+fields[i][0]+&quot;_div&quot;).html(html);
		}else{
			$(formId + &#x27; #&#x27;+fields[i][0]).val(object[fields[i][0]]);
		}
	    
	}
});

/**
 * Cancel edit or add new on modules
 * @method cancel
 */

IceHRMBase.method(&#x27;cancel&#x27;, function() {
	$(&quot;#&quot;+this.getTableName()+&#x27;Form&#x27;).hide();
	$(&quot;#&quot;+this.getTableName()).show();
});

IceHRMBase.method(&#x27;renderFormField&#x27;, function(field) {
	var userId = 0;
	if(this.fieldTemplates[field[1].type] == undefined || this.fieldTemplates[field[1].type] == null){
		return &quot;&quot;;
	}
	var t = this.fieldTemplates[field[1].type];
	if(field[1].validation != &quot;none&quot; &amp;&amp;  field[1].validation != &quot;emailOrEmpty&quot; &amp;&amp; field[1].type != &quot;placeholder&quot; &amp;&amp; field[1].label.indexOf(&#x27;*&#x27;) &lt; 0){
		field[1].label = field[1].label + &#x27;&lt;font class=&quot;redFont&quot;&gt;*&lt;/font&gt;&#x27;;
	}
	if(field[1].type == &#x27;text&#x27; || field[1].type == &#x27;textarea&#x27; || field[1].type == &#x27;hidden&#x27; || field[1].type == &#x27;label&#x27; || field[1].type == &#x27;placeholder&#x27;){
		t = t.replace(/_id_/g,field[0]);
		t = t.replace(/_label_/g,field[1].label);
		
	}else if(field[1].type == &#x27;select&#x27; || field[1].type == &#x27;select2&#x27; || field[1].type == &#x27;select2multi&#x27;){
		t = t.replace(/_id_/g,field[0]);
		t = t.replace(/_label_/g,field[1].label);
		if(field[1][&#x27;source&#x27;] != undefined &amp;&amp; field[1][&#x27;source&#x27;] != null ){
			t = t.replace(&#x27;_options_&#x27;,this.renderFormSelectOptions(field[1].source));
		}else if(field[1][&#x27;remote-source&#x27;] != undefined &amp;&amp; field[1][&#x27;remote-source&#x27;] != null ){
			var key = field[1][&#x27;remote-source&#x27;][0]+&quot;_&quot;+field[1][&#x27;remote-source&#x27;][1]+&quot;_&quot;+field[1][&#x27;remote-source&#x27;][2];
			t = t.replace(&#x27;_options_&#x27;,this.renderFormSelectOptionsRemote(this.fieldMasterData[key],field));
		}
		
	}else if(field[1].type == &#x27;date&#x27;){
		t = t.replace(/_id_/g,field[0]);
		t = t.replace(/_label_/g,field[1].label);
	
	}else if(field[1].type == &#x27;datetime&#x27;){
		t = t.replace(/_id_/g,field[0]);
		t = t.replace(/_label_/g,field[1].label);
	
	}else if(field[1].type == &#x27;time&#x27;){
		t = t.replace(/_id_/g,field[0]);
		t = t.replace(/_label_/g,field[1].label);
		
	}else if(field[1].type == &#x27;fileupload&#x27;){
		t = t.replace(/_id_/g,field[0]);
		t = t.replace(/_label_/g,field[1].label);
		var ce = this.getCurrentProfile();
		if(ce != null &amp;&amp; ce != undefined){
			userId = ce.id;
		}else{
			userId = this.getUser().id * -1;
		}
		t = t.replace(/_userId_/g,userId);
		t = t.replace(/_group_/g,this.tab);
		
		/*
		if(object != null &amp;&amp; object != undefined &amp;&amp; object[field[0]] != null &amp;&amp; object[field[0]] != undefined &amp;&amp; object[field[0]] != &quot;&quot;){
			t = t.replace(/_id___rand_/g,field[0]);
		}
		*/
		t = t.replace(/_rand_/g,this.generateRandom(14));
		
	}else if(field[1].type == &#x27;datagroup&#x27;){
		t = t.replace(/_id_/g,field[0]);
		t = t.replace(/_label_/g,field[1].label);
	}
	
	if(field[1].validation != undefined &amp;&amp; field[1].validation != null &amp;&amp; field[1].validation != &quot;&quot;){
		t = t.replace(/_validation_/g,&#x27;validation=&quot;&#x27;+field[1].validation+&#x27;&quot;&#x27;);
	}else{
		t = t.replace(/_validation_/g,&#x27;&#x27;);
	}
	return t;
});

IceHRMBase.method(&#x27;renderFormSelectOptions&#x27;, function(options) {
	var html = &quot;&quot;;
	
	//Sort options
	
	var tuples = [];

	for (var key in options) {
		tuples.push(options[key]);
	}

	tuples.sort(function(a, b) {
	    a = a[1];
	    b = b[1];

	    return a &lt; b ? -1 : (a &gt; b ? 1 : 0);
	});

	for (var i = 0; i &lt; tuples.length; i++) {
	    var prop = tuples[i][0];
	    var value = tuples[i][1];
	    var t = &#x27;&lt;option value=&quot;_id_&quot;&gt;_val_&lt;/option&gt;&#x27;;
		t = t.replace(&#x27;_id_&#x27;, prop);
		t = t.replace(&#x27;_val_&#x27;, value);
		html += t;
	    
	}
	return html;
	
});

IceHRMBase.method(&#x27;renderFormSelectOptionsRemote&#x27;, function(options,field) {
	var html = &quot;&quot;;
	if(field[1][&#x27;allow-null&#x27;] == true){
		if(field[1][&#x27;null-label&#x27;] != undefined &amp;&amp; field[1][&#x27;null-label&#x27;] != null){
			html += &#x27;&lt;option value=&quot;NULL&quot;&gt;&#x27;+field[1][&#x27;null-label&#x27;]+&#x27;&lt;/option&gt;&#x27;;
		}else{
			html += &#x27;&lt;option value=&quot;NULL&quot;&gt;Select&lt;/option&gt;&#x27;;
		}
		
	}
	
	//Sort options
	
	var tuples = [];

	for (var key in options) {
		tuples.push([key, options[key]]);
	}

	tuples.sort(function(a, b) {
	    a = a[1];
	    b = b[1];

	    return a &lt; b ? -1 : (a &gt; b ? 1 : 0);
	});

	for (var i = 0; i &lt; tuples.length; i++) {
	    var prop = tuples[i][0];
	    var value = tuples[i][1];

	    var t = &#x27;&lt;option value=&quot;_id_&quot;&gt;_val_&lt;/option&gt;&#x27;;
		t = t.replace(&#x27;_id_&#x27;, prop);
		t = t.replace(&#x27;_val_&#x27;, value);
		html += t;
	}
	
	
	return html;
	
});

IceHRMBase.method(&#x27;setTemplates&#x27;, function(templates) {
	this.templates = templates;
});

IceHRMBase.method(&#x27;setCustomTemplates&#x27;, function(templates) {
	this.customTemplates = templates;
});

IceHRMBase.method(&#x27;setEmailTemplates&#x27;, function(templates) {
	this.emailTemplates = templates;
});

IceHRMBase.method(&#x27;getCustomTemplate&#x27;, function(file) {
	return this.customTemplates[file];
});

IceHRMBase.method(&#x27;setFieldTemplates&#x27;, function(templates) {
	this.fieldTemplates = templates;
});


IceHRMBase.method(&#x27;getMetaFieldForRendering&#x27;, function(fieldName) {
	return &quot;&quot;;
});

IceHRMBase.method(&#x27;clearDeleteParams&#x27;, function() {
	this.deleteParams = {};
});

IceHRMBase.method(&#x27;getShowAddNew&#x27;, function() {
	return this.showAddNew;
});

/**
 * Override this method to change add new button label
 * @method getAddNewLabel
 */

IceHRMBase.method(&#x27;getAddNewLabel&#x27;, function() {
	return &quot;Add New&quot;;
});

/**
 * Used to set whether to show the add new button for a module
 * @method setShowAddNew
 * @param showAddNew {Boolean} value
 */

IceHRMBase.method(&#x27;setShowAddNew&#x27;, function(showAddNew) {
	this.showAddNew = showAddNew;
});

/**
 * Used to set whether to show delete button for each entry in module
 * @method setShowDelete
 * @param val {Boolean} value
 */
IceHRMBase.method(&#x27;setShowDelete&#x27;, function(val) {
	this.showDelete = val;
});


/**
 * Used to set whether to show edit button for each entry in module
 * @method setShowEdit
 * @param val {Boolean} value
 */

IceHRMBase.method(&#x27;setShowEdit&#x27;, function(val) {
	this.showEdit = val;
});

/**
 * Used to set whether to show save button in form
 * @method setShowSave
 * @param val {Boolean} value
 */


IceHRMBase.method(&#x27;setShowSave&#x27;, function(val) {
	this.showSave = val;
});


/**
 * Used to set whether to show cancel button in form
 * @method setShowCancel
 * @param val {Boolean} value
 */

IceHRMBase.method(&#x27;setShowCancel&#x27;, function(val) {
	this.showCancel = val;
});

/**
 * Datatable option array will be extended with associative array provided here
 * @method getCustomTableParams
 * @param val {Boolean} value
 */


IceHRMBase.method(&#x27;getCustomTableParams&#x27;, function() {
	return {};
});

IceHRMBase.method(&#x27;getActionButtons&#x27;, function(obj) {
	return modJs.getActionButtonsHtml(obj.aData[0],obj.aData);
});


/**
 * This return html for action buttons in each row. Override this method if you need to make changes to action buttons.
 * @method getActionButtonsHtml
 * @param id {int} id of the row
 * @param data {Array} data for the row
 * @returns {String} html for action buttons
 */

IceHRMBase.method(&#x27;getActionButtonsHtml&#x27;, function(id,data) {	
	var editButton = &#x27;&lt;img class=&quot;tableActionButton&quot; src=&quot;_BASE_images/edit.png&quot; style=&quot;cursor:pointer;&quot; rel=&quot;tooltip&quot; title=&quot;Edit&quot; onclick=&quot;modJs.edit(_id_);return false;&quot;&gt;&lt;/img&gt;&#x27;;
	var deleteButton = &#x27;&lt;img class=&quot;tableActionButton&quot; src=&quot;_BASE_images/delete.png&quot; style=&quot;margin-left:15px;cursor:pointer;&quot; rel=&quot;tooltip&quot; title=&quot;Delete&quot; onclick=&quot;modJs.deleteRow(_id_);return false;&quot;&gt;&lt;/img&gt;&#x27;;
	var html = &#x27;&lt;div style=&quot;width:80px;&quot;&gt;_edit__delete_&lt;/div&gt;&#x27;;
	
	if(this.showDelete){
		html = html.replace(&#x27;_delete_&#x27;,deleteButton);
	}else{
		html = html.replace(&#x27;_delete_&#x27;,&#x27;&#x27;);
	}
	
	if(this.showEdit){
		html = html.replace(&#x27;_edit_&#x27;,editButton);
	}else{
		html = html.replace(&#x27;_edit_&#x27;,&#x27;&#x27;);
	}
	
	html = html.replace(/_id_/g,id);
	html = html.replace(/_BASE_/g,this.baseUrl);
	return html;
});


/**
 * Generates a random string
 * @method generateRandom
 * @param length {int} required length of the string
 * @returns {String} random string
 */

IceHRMBase.method(&#x27;generateRandom&#x27;, function(length) {
	var d = new Date();
	var chars = &#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;;
	var result = &#x27;&#x27;;
	for (var i = length; i &gt; 0; --i) result += chars[Math.round(Math.random() * (chars.length - 1))];
	return result+d.getTime();
});



IceHRMBase.method(&#x27;checkFileType&#x27;, function (elementName, fileTypes) {
	var fileElement = document.getElementById(elementName);
	var fileExtension = &quot;&quot;;
	if (fileElement.value.lastIndexOf(&quot;.&quot;) &gt; 0) {
		fileExtension = fileElement.value.substring(fileElement.value.lastIndexOf(&quot;.&quot;) + 1, fileElement.value.length);
	}
	
	fileExtension = fileExtension.toLowerCase();
	
	var allowed = fileTypes.split(&quot;,&quot;);
	
	if (allowed.indexOf(fileExtension) &lt; 0) {
		fileElement.value = &quot;&quot;;
		this.showMessage(&quot;File Type Error&quot;,&#x27;Selected file type is not supported&#x27;);
		this.clearFileElement(elementName);
		return false;
	}
	
	return true;
	
});

IceHRMBase.method(&#x27;clearFileElement&#x27;, function (elementName) {

	var control = $(&quot;#&quot;+elementName);
	control.replaceWith( control = control.val(&#x27;&#x27;).clone( true ) );
});


IceHRMBase.method(&#x27;fixJSON&#x27;, function (json) {
	if(this.noJSONRequests == &quot;1&quot;){
		json = json.replace(/&quot;/g,&#x27;|&#x27;);
	}
	return json;
});


IceHRMBase.method(&#x27;getClientDate&#x27;, function (date) {

	var offset = this.getClientGMTOffset();
    var tzDate = date.addMinutes(offset*60);
    return tzDate;

});

IceHRMBase.method(&#x27;getClientGMTOffset&#x27;, function () {
	
	var rightNow = new Date();
	var jan1 = new Date(rightNow.getFullYear(), 0, 1, 0, 0, 0, 0);
	var temp = jan1.toGMTString();
	var jan2 = new Date(temp.substring(0, temp.lastIndexOf(&quot; &quot;)-1));
	var std_time_offset = (jan1 - jan2) / (1000 * 60 * 60);
	
	return std_time_offset;
	
});

/**
 * Override this method in a module to provide the help link for the module. Help link of the module on frontend will get updated with this.
 * @method getHelpLink
 * @returns {String} help link
 */

IceHRMBase.method(&#x27;getHelpLink&#x27;, function () {

	return null;

});
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
